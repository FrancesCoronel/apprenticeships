{{- $.Scratch.Add "index" slice -}}
{{- $section := $.Site.GetPage "section" .Section }}
{{- range $index, $element := (.Site.AllPages) -}}
  {{- if or (and ($element.IsDescendant $section) (and (not $element.Draft) (not $element.Params.private))) $section.IsHome -}}
    {{ with $element.Params.company }}
      {{- $.Scratch.Add "index" (dict "id" $index "company" $element.Date.UTC.Unix "description" $element.Description "company" $element.Params.company "location" $element.Params.location "link" $element.Params.Link "image" $element.Params.image)}}
    {{- end -}}
  {{- end -}}
{{- end -}}
{{- $.Scratch.Get "index" | jsonify -}}